<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
<link rel="stylesheet" href="../resource/css/common.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" referrerpolicy="no-referrer"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5.3.0/dist/echarts.min.js"></script>
<script type="text/javascript" src="../resource/js/common.util.js"></script>

<script>


var getInterestStockByDate = function(){

	var params = paramToObject();
	var xhr = new XMLHttpRequest();

	xhr.open("GET" , `http://112.144.208.118:8888/getInterestStockByDate?date=${params.date}`, true);
	xhr.onreadystatechange = function(){
		
		if( xhr.readyState == 4 && xhr.status == 200)
		{
			var d = JSON.parse( xhr.responseText )
			renderInterestStockByDate( d.data )
		}
	}

	xhr.send();

}

var renderInterestStockByDate = function( d ){
	
	console.log( "[ S ] - renderInterestStockByDate" )
	
	var _html = "";
//	var i = 0,iLen = d.length,io;
	var i = 0,iLen = 100,io;
	for(;i<iLen;++i){
		io = d[ i ]
		var curData = window.socketData.renderTradeValueInfo_object[ io.cd ]
		var color00 = "red"
		var symbol = "▲"
		if( curData.rt < 0 ) 
		{
			color00 = "blue"	
			var symbol = "▼"
		}
		if( curData.rt == 0 )
		{
			color00 = "gery"	
			var symbol = "-"
		}

		var color = generateColor('#FF0000','#cccccc',io.gap)				
		 _html += `
		 <div class="card" style="padding: 10px;box-shadow: 0 1px 1px 0 #ccc, 0 0 0 1px #ccc !important;border-radius: 0rem !important;display:block;cursor:pointer;" id="mass_b_00_${io.cd}" data-cd-value="${io.cd}" data-nm-value="${io.nm}">
			
			<div class="">

			<!--div class="right floated meta" style="position: relative;color: #${color};padding: 5px;min-width: 30px;text-align: center;font-size:15px;font-weight:bold;">${curData.price}( ${ ( curData.rt ).toFixed(2)}</div-->
			<span style="font-size:15px;"> ${io.nm}</span><span style="font-size:11px;">  ${io.cd}</span> 	
				<div style="font-size:16px;color:${color00}">${window.UTIL.Number.numberWithCommas(curData.price)} 
					<span style="font-size:12px;color:${color00}">${symbol} ${window.UTIL.Number.numberWithCommas( curData.prevChange )}( ${ ( curData.rt ).toFixed(2)}% )</span><br>
					<span style="font-size:12px;color:${color00}">${window.UTIL.Number.longNumberAddString( curData.tradeValue ) }</span>
				</div>
			<div style="font-size:11px;">
			개인   : ${window.UTIL.Number.longNumberAddString( io.pp.tr1 )} | 외국인 : ${window.UTIL.Number.longNumberAddString( io.pp.tr2 )} | 기관계 : ${window.UTIL.Number.longNumberAddString( io.pp.tr3 )}
			</div>
			</div>

			<div class="image" style="background-color: #fff/*${color}*/;">
				<div style="position: relative;color: #fff;padding: 5px;min-width: 30px;text-align: center;font-size:15px;font-weight:bold;"></div>
				<img src="https://t1.daumcdn.net/finance/chart/kr/stock/d/A${io.cd}.png" style="" load="lazy">
				
			</div>
			<!--div class="description">
			</div-->

			</div>
			
		 </div>
		`
		

		//var new_el = htmlToElement( _html )
		////window._el.id_interest.insertBefore( new_el,window._el.id_interest.firstChild )	
		//window._el.id_interest.appendChild( new_el )	
		
		//new_el.addEventListener( "click",function(e){

		//	var cd = e.currentTarget.getAttribute( "data-cd-value" );
		//	var a = window.document.createElement( "a" );
		//	a.target = "_blank";
		//	a.href = "/html/candle.html?cd=" + cd
		//	a.click();
		//	a = null;
		
		//})

	}
	window._el.id_interest.innerHTML = _html
	
	window._el.id_interest.addEventListener( "click",function(e){
		debugger;
		var cd = e.currentTarget.getAttribute( "data-cd-value" );
		var a = window.document.createElement( "a" );
		a.target = "_blank";
		a.href = "/html/candle.html?cd=" + cd
		a.click();
		a = null;

	})
	
	console.log( "[ E ] - window.wsFns.renderMassTransList_buy" )


}


window.addEventListener('DOMContentLoaded', (event) => {


	//-------------------------------------------------------;
	//-------------------------------------------------------;
	//-------------------------------------------------------;
	//-------------------------------------------------------;
	//-------------------------------------------------------;

	window._el = {}
	window._el.id_mass_b_rank = window.document.getElementById( "mass_b_rank")
	window._el.id_mass_s_rank = window.document.getElementById( "mass_s_rank")
	window._el.id_mass_s = window.document.getElementById("mass_s");
	window._el.id_mass_b = window.document.getElementById("mass_b");
	window._el.id_FtrData = window.document.getElementById("FtrData");
	window._el.id_AgcData = window.document.getElementById("AgcData");
	window._el.id_news = window.document.getElementById("news");
	window._el.id_chart00 = window.document.getElementById("chart00");
	window._el.id_mass_b_s = window.document.getElementById("mass_b_s");
	window._el.id_trd_data = window.document.getElementById("trd_data");
	window._el.id_realTimeChart = window.document.getElementById("realTimeChart");
	window._el.id_totalTradPrice = window.document.getElementById("totalTradPrice");
	window._el.id_search = window.document.getElementById("search");
	window._el.id_searchResult = window.document.getElementById("searchResult");
	window._el.id_stockInfo = window.document.getElementById("stockInfo");
	window._el.id_search_wrap = window.document.getElementById("search_wrap");
	window._el.id_tree_wics = window.document.getElementById( "tree_wics" )
	window._el.id_wics_stocks = window.document.getElementById( "wics_stocks" )
	window._el.id_market_index = window.document.getElementById( "market_index" )
	window._el.id_market_index_1 = window.document.getElementById( "market_index_1" )
	window._el.id_rank_rt = window.document.getElementById( "rank_rt" )
	window._el.id_interest = window.document.getElementById( "interest" )

	window._el.id_menu_00 = window.document.getElementById("menu_00");
	window._el.id_menu_01 = window.document.getElementById("menu_01");
	window._el.id_menu_02 = window.document.getElementById("menu_02");
	window._el.id_menu_03 = window.document.getElementById("menu_03");

	//-------------------------------------------------------;
	//-------------------------------------------------------;
	//-------------------------------------------------------;
	//-------------------------------------------------------;
	//-------------------------------------------------------;


	window.MassData = {};
	window.MassData.b = {};
	window.MassData.s = {};

	window.MassDataRank = [];

	window.socketData = {}
	window._data = {};
	window._data.b = [];
	window._data.s = [];

	window.MassDataInfo = {}
	window.MassDataInfo.b = 0
	window.MassDataInfo.s = 0

	window.stock = {};
	window.stock_arr = [];

	window.date = {}
	window.date.curDate = getTimeTo__YYYYMMDD();
	window.date.curDateWidhDash = getTimeTo__YYYY_MM_DD();


	//-------------------------------------------------------;
	//-------------------------------------------------------;
	//-------------------------------------------------------;
	//-------------------------------------------------------;
	//-------------------------------------------------------;



	//getInterestStockByDate();


	//-------------------------------------------------------;
	//-------------------------------------------------------;
	//-------------------------------------------------------;
	//-------------------------------------------------------;
	//-------------------------------------------------------;
	window.Websocket.init();
	window.COMPONENT.gnb();
	window.COMPONENT.stockSearch_global();

})
</script>

<body style="padding:50px;">
	<div class="ui stackable grid">
		<div id="gnb" class="eight wide column" style="padding: 20px;"></div>
		<div id="search_wrap" class="eight wide column" style="padding: 20px;"></div>

		<div class="sixteen wide column">
			<div class="ui grid">
				<div class="sixteen wide column" id="market_index_title" style="">
				국내외증시
				</div>
				<div class="six wide column">
					<div class="ui two cards" id="market_index"></div>
				</div>
				<div class="ten wide column">
					<div class="ui five cards" id="market_index_1"></div>
				</div>
			</div>
		</div>
		<div class="sixteen wide column">
			<div class="ui grid">
				<div class="sixteen wide column" id="" style="">
					<div class="ui six cards" id="interest"></div>
				</div>
			</div>
		</div>
	</div>
</body>